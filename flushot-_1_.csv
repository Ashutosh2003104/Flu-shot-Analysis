"{ ""cells"": [ { ""cell_type"": ""code"", ""execution_count"": 1, ""id"": ""d4d077bb-c7e3-4564-801f-0127ad1833bd"", ""metadata"": {}, ""outputs"": [], ""source"": [ ""from pathlib import Path\n"", ""\n"", ""import numpy as np\n"", ""import pandas as"
"pd\n"", ""\n"", ""pd.set_option(\""display.max_columns\"", 100)"" ] }, { ""cell_type"": ""code"", ""execution_count"": 28, ""id"": ""aa638ce7-878d-4006-a0d6-729e65df3a01"", ""metadata"": {}, ""outputs"": [], ""source"": [ ""features_df ="
"pd.read_csv(\""training_set_features.csv\"", \n"", "" index_col=\""respondent_id\""\n"", "")\n"", ""labels_df = pd.read_csv(\""training_set_labels.csv\"", \n"", "" index_col=\""respondent_id\""\n"", "")"" ] }, { ""cell_type"": ""code"", ""execution_count"":"
"30, ""id"": ""ca7fafef-1802-42ac-b114-9b679d11bb95"", ""metadata"": {}, ""outputs"": [ { ""name"": ""stdout"", ""output_type"": ""stream"", ""text"": [ ""features_df.shape (26707, 35)\n"" ] }, { ""data"": { ""text/html"": [ """
"\n"", ""\n"", ""\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"","
""" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"","
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"","
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"","
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"","
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"h1n1_concern h1n1_knowledge behavioral_antiviral_meds behavioral_avoidance behavioral_face_mask behavioral_wash_hands behavioral_large_gatherings behavioral_outside_home behavio"
"respondent_id"
""
"0           1.0                  0.0                     0.0                                   0.0                            0.0                             0.0                                0.0                                      1.0                                 1.0"
""
"1           3.0                  2.0                     0.0                                   1.0                            0.0                             1.0                                0.0                                      1.0                                 1.0"
""
"2           1.0                  1.0                     0.0                                   1.0                            0.0                             0.0                                0.0                                      0.0                                 0.0"
""
"3           1.0                  1.0                     0.0                                   1.0                            0.0                             1.0                                1.0                                      0.0                                 0.0"
""
"4           2.0                  1.0                     0.0                                   1.0                            0.0                             1.0                                1.0                                      0.0                                 1.0"
"\n"", """
""" ], ""text/plain"": [ "" h1n1_concern h1n1_knowledge behavioral_antiviral_meds \\\n"", ""respondent_id \n"", ""0 1.0 0.0 0.0 \n"", ""1 3.0 2.0 0.0 \n"", ""2 1.0 1.0 0.0 \n"", ""3 1.0 1.0 0.0 \n"", ""4 2.0 1.0 0.0 \n"", ""\n"", "" behavioral_avoidance"
"behavioral_face_mask \\\n"", ""respondent_id \n"", ""0 0.0 0.0 \n"", ""1 1.0 0.0 \n"", ""2 1.0 0.0 \n"", ""3 1.0 0.0 \n"", ""4 1.0 0.0 \n"", ""\n"", "" behavioral_wash_hands behavioral_large_gatherings \\\n"", ""respondent_id \n"", ""0 0.0 0.0 \n"", ""1 1."
"0.0 \n"", ""2 0.0 0.0 \n"", ""3 1.0 1.0 \n"", ""4 1.0 1.0 \n"", ""\n"", "" behavioral_outside_home behavioral_touch_face \\\n"", ""respondent_id \n"", ""0 1.0 1.0 \n"", ""1 1.0 1.0 \n"", ""2 0.0 0.0 \n"", ""3 0.0 0.0 \n"", ""4 0.0 1.0 \n"", ""\n"", """
"doctor_recc_h1n1 doctor_recc_seasonal chronic_med_condition \\\n"", ""respondent_id \n"", ""0 0.0 0.0 0.0 \n"", ""1 0.0 0.0 0.0 \n"", ""2 NaN NaN 1.0 \n"", ""3 0.0 1.0 1.0 \n"", ""4 0.0 0.0 0.0 \n"", ""\n"", "" child_under_6_months"
"health_worker health_insurance \\\n"", ""respondent_id \n"", ""0 0.0 0.0 1.0 \n"", ""1 0.0 0.0 1.0 \n"", ""2 0.0 0.0 NaN \n"", ""3 0.0 0.0 NaN \n"", ""4 0.0 0.0 NaN \n"", ""\n"", "" opinion_h1n1_vacc_effective opinion_h1n1_risk \\\n"","
"""respondent_id \n"", ""0 3.0 1.0 \n"", ""1 5.0 4.0 \n"", ""2 3.0 1.0 \n"", ""3 3.0 3.0 \n"", ""4 3.0 3.0 \n"", ""\n"", "" opinion_h1n1_sick_from_vacc opinion_seas_vacc_effective \\\n"", ""respondent_id \n"", ""0 2.0 2.0 \n"", ""1 4.0 4.0 \n"", ""2 1.0 4.0 \n"
"""3 5.0 5.0 \n"", ""4 2.0 3.0 \n"", ""\n"", "" opinion_seas_risk opinion_seas_sick_from_vacc age_group \\\n"", ""respondent_id \n"", ""0 1.0 2.0 55 - 64 Years \n"", ""1 2.0 4.0 35 - 44 Years \n"", ""2 1.0 2.0 18 - 34 Years \n"", ""3 4.0 1.0 65+"
"Years \n"", ""4 1.0 4.0 45 - 54 Years \n"", ""\n"", "" education race sex income_poverty \\\n"", ""respondent_id \n"", ""0 < 12 Years White Female Below Poverty \n"", ""1 12 Years White Male Below Poverty \n"", ""2 College Graduate"
"White Male <= $75,000, Above Poverty \n"", ""3 12 Years White Female Below Poverty \n"", ""4 Some College White Female <= $75,000, Above Poverty \n"", ""\n"", "" marital_status rent_or_own employment_status"
"hhs_geo_region \\\n"", ""respondent_id \n"", ""0 Not Married Own Not in Labor Force oxchjgsf \n"", ""1 Not Married Rent Employed bhuqouqj \n"", ""2 Not Married Own Employed qufhixun \n"", ""3 Not Married Rent Not in Labor Force"
"lrircsnp \n"", ""4 Married Own Employed qufhixun \n"", ""\n"", "" census_msa household_adults household_children \\\n"", ""respondent_id \n"", ""0 Non-MSA 0.0 0.0 \n"", ""1 MSA, Not Principle City 0.0 0.0 \n"", ""2 MSA, Not Principle"
"City 2.0 0.0 \n"", ""3 MSA, Principle City 0.0 0.0 \n"", ""4 MSA, Not Principle City 1.0 0.0 \n"", ""\n"", "" employment_industry employment_occupation \n"", ""respondent_id \n"", ""0 NaN NaN \n"", ""1 pxcmvdjn xgwztkwe \n"", ""2 rucpziij"
"xtkaffoo \n"", ""3 NaN NaN \n"", ""4 wxleyezf emcorrxb "" ] }, ""execution_count"": 30, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": [ ""print(\""features_df.shape\"", features_df.shape)\n"", ""features_df.head()"" ] }, {"
"""cell_type"": ""code"", ""execution_count"": 32, ""id"": ""6ddf8992-210c-4ed7-a756-efbd0498eb16"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""text/plain"": [ ""h1n1_concern float64\n"", ""h1n1_knowledge float64\n"","
"""behavioral_antiviral_meds float64\n"", ""behavioral_avoidance float64\n"", ""behavioral_face_mask float64\n"", ""behavioral_wash_hands float64\n"", ""behavioral_large_gatherings float64\n"", ""behavioral_outside_home float64\n"","
"""behavioral_touch_face float64\n"", ""doctor_recc_h1n1 float64\n"", ""doctor_recc_seasonal float64\n"", ""chronic_med_condition float64\n"", ""child_under_6_months float64\n"", ""health_worker float64\n"", ""health_insurance"
"float64\n"", ""opinion_h1n1_vacc_effective float64\n"", ""opinion_h1n1_risk float64\n"", ""opinion_h1n1_sick_from_vacc float64\n"", ""opinion_seas_vacc_effective float64\n"", ""opinion_seas_risk float64\n"","
"""opinion_seas_sick_from_vacc float64\n"", ""age_group object\n"", ""education object\n"", ""race object\n"", ""sex object\n"", ""income_poverty object\n"", ""marital_status object\n"", ""rent_or_own object\n"", ""employment_status"
"object\n"", ""hhs_geo_region object\n"", ""census_msa object\n"", ""household_adults float64\n"", ""household_children float64\n"", ""employment_industry object\n"", ""employment_occupation object\n"", ""dtype: object"" ] },"
"""execution_count"": 32, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": [ ""features_df.dtypes"" ] }, { ""cell_type"": ""code"", ""execution_count"": 34, ""id"": ""492f1e6f-f3ea-4156-8088-bf18aa57ecd5"", ""metadata"": {},"
"""outputs"": [ { ""name"": ""stdout"", ""output_type"": ""stream"", ""text"": [ ""labels_df.shape (26707, 2)\n"" ] }, { ""data"": { ""text/html"": [ """
"\n"", ""\n"", ""\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"","
"h1n1_vaccine seasonal_vaccine"
"respondent_id"
"0           0                   0"
"1           0                   1"
"2           0                   0"
"3           0                   1"
"4           0                   0"
"\n"", """
""" ], ""text/plain"": [ "" h1n1_vaccine seasonal_vaccine\n"", ""respondent_id \n"", ""0 0 0\n"", ""1 0 1\n"", ""2 0 0\n"", ""3 0 1\n"", ""4 0 0"" ] }, ""execution_count"": 34, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": ["
"""print(\""labels_df.shape\"", labels_df.shape)\n"", ""labels_df.head()"" ] }, { ""cell_type"": ""code"", ""execution_count"": 36, ""id"": ""d03a28d8-1586-4899-959b-83c345a6a22a"", ""metadata"": {}, ""outputs"": [], ""source"": ["
"""np.testing.assert_array_equal(features_df.index.values, labels_df.index.values)"" ] }, { ""cell_type"": ""code"", ""execution_count"": 40, ""id"": ""cd93f57c-0558-4248-8b09-ce2957e270bb"", ""metadata"": {}, ""outputs"": [], ""source"": ["
"""%matplotlib inline\n"", ""import matplotlib.pyplot as plt"" ] }, { ""cell_type"": ""code"", ""execution_count"": 50, ""id"": ""6d055d86-5d70-4a17-809f-8627d3b771ce"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""image/png"":"
"""iVBORw0KGgoAAAANSUhEUgAAAnYAAAHWCAYAAAD6oMSKAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjkuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8hTgPZAAAACXBIWXMAAA9hAAAPYQG"
"""text/plain"": [ """
""
""" ] }, ""metadata"": {}, ""output_type"": ""display_data"" } ], ""source"": [ ""fig, ax = plt.subplots(2, 1, sharex=True)\n"", ""\n"", ""n_obs = labels_df.shape[0]\n"", ""\n"", ""(labels_df['h1n1_vaccine']\n"", "" .value_counts()\n"", """
".div(n_obs)\n"", "" .plot.barh(title=\""Proportion of H1N1 Vaccine\"", ax=ax[0])\n"", "")\n"", ""ax[0].set_ylabel(\""h1n1_vaccine\"")\n"", ""\n"", ""(labels_df['seasonal_vaccine']\n"", "" .value_counts()\n"", "" .div(n_obs)\n"", """
".plot.barh(title=\""Proportion of Seasonal Vaccine\"", ax=ax[1])\n"", "")\n"", ""ax[1].set_ylabel(\""seasonal_vaccine\"")\n"", ""fig.tight_layout()\n"", ""plt.show()"" ] }, { ""cell_type"": ""code"", ""execution_count"": 52, ""id"": ""a3dec2fc-"
"68ef-4e60-bec8-281a93b4f395"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""text/html"": [ """
"\n"", ""\n"", ""\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"seasonal_vaccine              0            1           All"
"h1n1_vaccine"
"0               0.497810 0.289737 0.787546"
"1               0.036582 0.175871 0.212454"
"All             0.534392 0.465608 1.000000"
"\n"", """
""" ], ""text/plain"": [ ""seasonal_vaccine 0 1 All\n"", ""h1n1_vaccine \n"", ""0 0.497810 0.289737 0.787546\n"", ""1 0.036582 0.175871 0.212454\n"", ""All 0.534392 0.465608 1.000000"" ] }, ""execution_count"": 52, ""metadata"":"
"{}, ""output_type"": ""execute_result"" } ], ""source"": [ ""pd.crosstab(\n"", "" labels_df[\""h1n1_vaccine\""], \n"", "" labels_df[\""seasonal_vaccine\""], \n"", "" margins=True,\n"", "" normalize=True\n"", "")"" ] }, { ""cell_type"": ""code"","
"""execution_count"": 54, ""id"": ""d3574338-a306-4420-bb26-71230c6d30a9"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""text/plain"": [ ""0.3771426530614447"" ] }, ""execution_count"": 54, ""metadata"": {}, ""output_type"":"
"""execute_result"" } ], ""source"": [ ""(labels_df[\""h1n1_vaccine\""]\n"", "" .corr(labels_df[\""seasonal_vaccine\""], method=\""pearson\"")\n"", "")"" ] }, { ""cell_type"": ""code"", ""execution_count"": 56, ""id"": ""db20036b-7902-4d83-8566-"
"60a2bba04eef"", ""metadata"": {}, ""outputs"": [ { ""name"": ""stdout"", ""output_type"": ""stream"", ""text"": [ ""(26707, 37)\n"" ] }, { ""data"": { ""text/html"": [ """
"\n"", ""\n"", ""\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"h1n1_concern h1n1_knowledge behavioral_antiviral_meds behavioral_avoidance behavioral_face_mask behavioral_wash_hands behavioral_large_gatherings behavioral_outside_home be"
"respondent_id"
""
"0          1.0                  0.0                     0.0                                   0.0                            0.0                             0.0                                0.0                                      1.0                                  1.0"
""
"1          3.0                  2.0                     0.0                                   1.0                            0.0                             1.0                                0.0                                      1.0                                  1.0"
""
"2          1.0                  1.0                     0.0                                   1.0                            0.0                             0.0                                0.0                                      0.0                                  0.0"
""
"3          1.0                  1.0                     0.0                                   1.0                            0.0                             1.0                                1.0                                      0.0                                  0.0"
""
"4          2.0                  1.0                     0.0                                   1.0                            0.0                             1.0                                1.0                                      0.0                                  1.0"
"\n"", """
""" ], ""text/plain"": [ "" h1n1_concern h1n1_knowledge behavioral_antiviral_meds \\\n"", ""respondent_id \n"", ""0 1.0 0.0 0.0 \n"", ""1 3.0 2.0 0.0 \n"", ""2 1.0 1.0 0.0 \n"", ""3 1.0 1.0 0.0 \n"", ""4 2.0 1.0 0.0 \n"", ""\n"", """
"behavioral_avoidance behavioral_face_mask \\\n"", ""respondent_id \n"", ""0 0.0 0.0 \n"", ""1 1.0 0.0 \n"", ""2 1.0 0.0 \n"", ""3 1.0 0.0 \n"", ""4 1.0 0.0 \n"", ""\n"", "" behavioral_wash_hands behavioral_large_gatherings \\\n"","
"""respondent_id \n"", ""0 0.0 0.0 \n"", ""1 1.0 0.0 \n"", ""2 0.0 0.0 \n"", ""3 1.0 1.0 \n"", ""4 1.0 1.0 \n"", ""\n"", "" behavioral_outside_home behavioral_touch_face \\\n"", ""respondent_id \n"", ""0 1.0 1.0 \n"", ""1 1.0 1.0 \n"", ""2 0.0 0.0 \n"","
"""3 0.0 0.0 \n"", ""4 0.0 1.0 \n"", ""\n"", "" doctor_recc_h1n1 doctor_recc_seasonal chronic_med_condition \\\n"", ""respondent_id \n"", ""0 0.0 0.0 0.0 \n"", ""1 0.0 0.0 0.0 \n"", ""2 NaN NaN 1.0 \n"", ""3 0.0 1.0 1.0 \n"", ""4 0.0 0.0 0.0"
"\n"", ""\n"", "" child_under_6_months health_worker health_insurance \\\n"", ""respondent_id \n"", ""0 0.0 0.0 1.0 \n"", ""1 0.0 0.0 1.0 \n"", ""2 0.0 0.0 NaN \n"", ""3 0.0 0.0 NaN \n"", ""4 0.0 0.0 NaN \n"", ""\n"", """
"opinion_h1n1_vacc_effective opinion_h1n1_risk \\\n"", ""respondent_id \n"", ""0 3.0 1.0 \n"", ""1 5.0 4.0 \n"", ""2 3.0 1.0 \n"", ""3 3.0 3.0 \n"", ""4 3.0 3.0 \n"", ""\n"", "" opinion_h1n1_sick_from_vacc opinion_seas_vacc_effective"
"\\\n"", ""respondent_id \n"", ""0 2.0 2.0 \n"", ""1 4.0 4.0 \n"", ""2 1.0 4.0 \n"", ""3 5.0 5.0 \n"", ""4 2.0 3.0 \n"", ""\n"", "" opinion_seas_risk opinion_seas_sick_from_vacc age_group \\\n"", ""respondent_id \n"", ""0 1.0 2.0 55 - 64 Years"
"\n"", ""1 2.0 4.0 35 - 44 Years \n"", ""2 1.0 2.0 18 - 34 Years \n"", ""3 4.0 1.0 65+ Years \n"", ""4 1.0 4.0 45 - 54 Years \n"", ""\n"", "" education race sex income_poverty \\\n"", ""respondent_id \n"", ""0 < 12 Years White Female"
"Below Poverty \n"", ""1 12 Years White Male Below Poverty \n"", ""2 College Graduate White Male <= $75,000, Above Poverty \n"", ""3 12 Years White Female Below Poverty \n"", ""4 Some College White Female <="
"$75,000, Above Poverty \n"", ""\n"", "" marital_status rent_or_own employment_status hhs_geo_region \\\n"", ""respondent_id \n"", ""0 Not Married Own Not in Labor Force oxchjgsf \n"", ""1 Not Married Rent Employed"
"bhuqouqj \n"", ""2 Not Married Own Employed qufhixun \n"", ""3 Not Married Rent Not in Labor Force lrircsnp \n"", ""4 Married Own Employed qufhixun \n"", ""\n"", "" census_msa household_adults household_children"
"\\\n"", ""respondent_id \n"", ""0 Non-MSA 0.0 0.0 \n"", ""1 MSA, Not Principle City 0.0 0.0 \n"", ""2 MSA, Not Principle City 2.0 0.0 \n"", ""3 MSA, Principle City 0.0 0.0 \n"", ""4 MSA, Not Principle City 1.0 0.0 \n"", ""\n"", """
"employment_industry employment_occupation h1n1_vaccine \\\n"", ""respondent_id \n"", ""0 NaN NaN 0 \n"", ""1 pxcmvdjn xgwztkwe 0 \n"", ""2 rucpziij xtkaffoo 0 \n"", ""3 NaN NaN 0 \n"", ""4 wxleyezf emcorrxb 0 \n"", ""\n"", """
"seasonal_vaccine \n"", ""respondent_id \n"", ""0 0 \n"", ""1 1 \n"", ""2 0 \n"", ""3 1 \n"", ""4 0 "" ] }, ""execution_count"": 56, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": [ ""joined_df = features_df.join(labels_df)\n"","
"""print(joined_df.shape)\n"", ""joined_df.head()"" ] }, { ""cell_type"": ""code"", ""execution_count"": 58, ""id"": ""6ac07e53-cef4-42de-9563-c17ba23b3830"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""text/html"": [ """
"\n"", ""\n"", ""\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"h1n1_vaccine 0               1"
"h1n1_concern"
"0.0          2849 447"
"1.0          6756 1397"
"2.0          8102 2473"
"3.0          3250 1341"
"\n"", """
""" ], ""text/plain"": [ ""h1n1_vaccine 0 1\n"", ""h1n1_concern \n"", ""0.0 2849 447\n"", ""1.0 6756 1397\n"", ""2.0 8102 2473\n"", ""3.0 3250 1341"" ] }, ""execution_count"": 58, ""metadata"": {}, ""output_type"": ""execute_result"" } ],"
"""source"": [ ""counts = (joined_df[['h1n1_concern', 'h1n1_vaccine']]\n"", "" .groupby(['h1n1_concern', 'h1n1_vaccine'])\n"", "" .size()\n"", "" .unstack('h1n1_vaccine')\n"", "" )\n"", ""counts"" ] }, { ""cell_type"": ""code"","
"""execution_count"": 65, ""id"": ""a852fe42-837d-419e-b2ff-41fea433037b"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""text/plain"": [ """" ] }, ""execution_count"": 65, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": ["
"""ax = counts.plot.barh()\n"", ""ax.invert_yaxis()\n"", ""ax.legend(\n"", "" loc='center right', \n"", "" bbox_to_anchor=(1.3, 0.5), \n"", "" title='h1n1_vaccine'\n"", "")"" ] }, { ""cell_type"": ""code"", ""execution_count"": 67, ""id"": ""57288f86-"
"44f4-41f3-bec3-e416b75b1c3f"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""text/plain"": [ ""h1n1_concern\n"", ""0.0 3296\n"", ""1.0 8153\n"", ""2.0 10575\n"", ""3.0 4591\n"", ""dtype: int64"" ] }, ""execution_count"": 67, ""metadata"": {},"
"""output_type"": ""execute_result"" } ], ""source"": [ ""h1n1_concern_counts = counts.sum(axis='columns')\n"", ""h1n1_concern_counts"" ] }, { ""cell_type"": ""code"", ""execution_count"": 69, ""id"": ""9e2d8006-da25-46a8-a6ab-"
"387d7984afdf"", ""metadata"": {}, ""outputs"": [], ""source"": [ ""def vaccination_rate_plot(col, target, data, ax=None):\n"", "" \""\""\""Stacked bar chart of vaccination rate for `target` against \n"", "" `col`. \n"", "" \n"", "" Args:\n"", "" col"
"(string): column name of feature variable\n"", "" target (string): column name of target variable\n"", "" data (pandas DataFrame): dataframe that contains columns \n"", "" `col` and `target`\n"", "" ax (matplotlib axes object,"
"optional): matplotlib axes \n"", "" object to attach plot to\n"", "" \""\""\""\n"", "" counts = (joined_df[[target, col]]\n"", "" .groupby([target, col])\n"", "" .size()\n"", "" .unstack(target)\n"", "" )\n"", "" group_counts ="
"counts.sum(axis='columns')\n"", "" props = counts.div(group_counts, axis='index')\n"", ""\n"", "" props.plot(kind=\""barh\"", stacked=True, ax=ax)\n"", "" ax.invert_yaxis()\n"", "" ax.legend().remove()"" ] }, { ""cell_type"": ""code"","
"""execution_count"": 77, ""id"": ""a6316e2a-6671-40c7-b1aa-40d7bdc732a5"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""image/png"":"
"""iVBORw0KGgoAAAANSUhEUgAAA3kAAAq1CAYAAABGQmnJAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjkuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8hTgPZAAAACXBIWXMAAA9hAAAP"
"""text/plain"": [ """
""
""" ] }, ""metadata"": {}, ""output_type"": ""display_data"" }, { ""data"": { ""image/png"":"
"""iVBORw0KGgoAAAANSUhEUgAAA2AAAAjDCAYAAADXHTweAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjkuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8hTgPZAAAACXBIWXMAAA9h"
"""text/plain"": [ """
""
""" ] }, ""metadata"": {}, ""output_type"": ""display_data"" } ], ""source"": [ ""cols_to_plot = [\n"", "" 'h1n1_concern',\n"", "" 'h1n1_knowledge',\n"", "" 'opinion_h1n1_vacc_effective',\n"", """
"'opinion_h1n1_risk',\n"", "" 'opinion_h1n1_sick_from_vacc',\n"", "" 'opinion_seas_vacc_effective',\n"", "" 'opinion_seas_risk',\n"", "" 'opinion_seas_sick_from_vacc',\n"", "" 'sex',\n"", "" 'age_group',\n"", """
"'race',\n"", ""]\n"", ""\n"", ""fig, ax = plt.subplots(\n"", "" len(cols_to_plot), 2, figsize=(9,len(cols_to_plot)*2.5)\n"", "")\n"", ""for idx, col in enumerate(cols_to_plot):\n"", "" vaccination_rate_plot(\n"", "" col,"
"'h1n1_vaccine', joined_df, ax=ax[idx, 0]\n"", "" )\n"", "" vaccination_rate_plot(\n"", "" col, 'seasonal_vaccine', joined_df, ax=ax[idx, 1]\n"", "" )\n"", "" \n"", ""ax[0, 0].legend(\n"", "" loc='lower center',"
"bbox_to_anchor=(0.5, 1.05), title='h1n1_vaccine'\n"", "")\n"", ""ax[0, 1].legend(\n"", "" loc='lower center', bbox_to_anchor=(0.5, 1.05), title='seasonal_vaccine'\n"", "")\n"", ""plt.show()\n"","
"""fig.tight_layout()\n"" ] }, { ""cell_type"": ""code"", ""execution_count"": 79, ""id"": ""994ef6fc-3ad1-44b2-babc-0a05df6d3bb7"", ""metadata"": {}, ""outputs"": [], ""source"": [ ""from sklearn.preprocessing"
"import StandardScaler\n"", ""from sklearn.impute import SimpleImputer\n"", ""from sklearn.compose import ColumnTransformer\n"", ""\n"", ""from sklearn.linear_model import"
"LogisticRegression\n"", ""from sklearn.multioutput import MultiOutputClassifier\n"", ""\n"", ""from sklearn.pipeline import Pipeline\n"", ""\n"", ""from sklearn.model_selection import train_test_split\n"","
"""\n"", ""from sklearn.metrics import roc_curve, roc_auc_score\n"", ""\n"", ""RANDOM_SEED = 6"" ] }, { ""cell_type"": ""code"", ""execution_count"": 81, ""id"": ""15b372cb-f145-4e77-b285-e241c6ecc2d4"","
"""metadata"": {}, ""outputs"": [ { ""data"": { ""text/plain"": [ ""h1n1_concern True\n"", ""h1n1_knowledge True\n"", ""behavioral_antiviral_meds True\n"", ""behavioral_avoidance True\n"","
"""behavioral_face_mask True\n"", ""behavioral_wash_hands True\n"", ""behavioral_large_gatherings True\n"", ""behavioral_outside_home True\n"", ""behavioral_touch_face True\n"","
"""doctor_recc_h1n1 True\n"", ""doctor_recc_seasonal True\n"", ""chronic_med_condition True\n"", ""child_under_6_months True\n"", ""health_worker True\n"", ""health_insurance True\n"","
"""opinion_h1n1_vacc_effective True\n"", ""opinion_h1n1_risk True\n"", ""opinion_h1n1_sick_from_vacc True\n"", ""opinion_seas_vacc_effective True\n"", ""opinion_seas_risk True\n"","
"""opinion_seas_sick_from_vacc True\n"", ""age_group False\n"", ""education False\n"", ""race False\n"", ""sex False\n"", ""income_poverty False\n"", ""marital_status False\n"", ""rent_or_own False\n"","
"""employment_status False\n"", ""hhs_geo_region False\n"", ""census_msa False\n"", ""household_adults True\n"", ""household_children True\n"", ""employment_industry False\n"","
"""employment_occupation False\n"", ""dtype: bool"" ] }, ""execution_count"": 81, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": [ ""features_df.dtypes != \""object\"""" ] }, { ""cell_type"":"
"""code"", ""execution_count"": 85, ""id"": ""40468a63-b70e-4a20-9634-455f08cb4d94"", ""metadata"": {}, ""outputs"": [], ""source"": [ ""from sklearn.pipeline import Pipeline\n"", ""from"
"sklearn.preprocessing import StandardScaler\n"", ""from sklearn.impute import SimpleImputer\n"", ""from sklearn.compose import ColumnTransformer\n"", ""\n"", ""# Example: Assume features_df"
"is your DataFrame\n"", ""# Replace this with your actual DataFrame\n"", ""# features_df = pd.DataFrame(...)\n"", ""\n"", ""# Step 1: Identify numeric columns\n"", ""# Use features_df.dtypes to filter"
"numeric columns (e.g., int64, float64)\n"", ""numeric_cols = features_df.select_dtypes(include=['int64', 'float64']).columns.tolist()\n"", ""\n"", ""# Step 2: Define the numeric preprocessing steps\n"","
"""numeric_preprocessing_steps = Pipeline([\n"", "" ('simple_imputer', SimpleImputer(strategy='median')), # Step 1: Impute missing values\n"", "" ('standard_scaler', StandardScaler()) # Step 2:"
"Scale the data\n"", ""])\n"", ""\n"", ""# Step 3: Create the preprocessor stage of the final pipeline\n"", ""preprocessor = ColumnTransformer(\n"", "" transformers=[\n"", "" (\""numeric\"","
"numeric_preprocessing_steps, numeric_cols) # Apply to numeric columns\n"", "" ],\n"", "" remainder=\""drop\"" # Drop columns not explicitly transformed\n"", "")"" ] }, { ""cell_type"": ""code"","
"""execution_count"": 87, ""id"": ""73fbc206-c062-48d0-8dcb-bb0c369e8cbc"", ""metadata"": {}, ""outputs"": [], ""source"": [ ""estimators = MultiOutputClassifier(\n"", """
"estimator=LogisticRegression(penalty=\""l2\"", C=1)\n"", "")"" ] }, { ""cell_type"": ""code"", ""execution_count"": 89, ""id"": ""2f9381e1-b56c-42d6-b88f-7354a4ebb188"", ""metadata"": {}, ""outputs"": [],"
"""source"": [ ""full_pipeline = Pipeline([\n"", "" (\""preprocessor\"", preprocessor),\n"", "" (\""estimators\"", estimators),\n"", ""])"" ] }, { ""cell_type"": ""code"", ""execution_count"": 91, ""id"": ""fde5e92a-37d8-421a-"
"9602-c69191a2f2e2"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""text/html"": [ """
"Pipeline(steps=[('preprocessor',\n"","
"""           ColumnTransformer(transformers=[('numeric',\n"","
"""                                Pipeline(steps=[('simple_imputer',\n"","
"""                                             SimpleImputer(strategy='median')),\n"","
"""                                            ('standard_scaler',\n"","
"""                                             StandardScaler())]),\n"","
"""                                ['h1n1_concern',\n"","
"""                                 'h1n1_knowledge',\n"","
"""                                 'behavioral_antiviral_meds',\n"","
"""                                 'behavioral_avoidance',\n"","
"""                                 'behavioral_face_mask',\n"","
"""                                 'behavioral_wash_hands',\n"","
"""                                 'behavioral_large_gatherings',\n"","
"""                                 'behavi...\n"","
"""                                 'chronic_med_condition',\n"","
"""                                 'child_under_6_months',\n"","
"""                                 'health_worker',\n"","
"""                                 'health_insurance',\n"","
"""                                 'opinion_h1n1_vacc_effective',\n"","
"""                                 'opinion_h1n1_risk',\n"","
"""                                 'opinion_h1n1_sick_from_vacc',\n"","
"""                                 'opinion_seas_vacc_effective',\n"","
"""                                 'opinion_seas_risk',\n"","
"""                                 'opinion_seas_sick_from_vacc',\n"","
"""                                 'household_adults',\n"","
"""                                 'household_children'])])),\n"","
"""          ('estimators',\n"","
"""           MultiOutputClassifier(estimator=LogisticRegression(C=1)))])"
""
"In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook."
"On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org."
""" ], ""text/plain"": [ ""Pipeline(steps=[('preprocessor',\n"", "" ColumnTransformer(transformers=[('numeric',\n"", "" Pipeline(steps=[('simple_imputer',\n"", "" SimpleImputer(strategy='median')),\n"", """
"('standard_scaler',\n"", "" StandardScaler())]),\n"", "" ['h1n1_concern',\n"", "" 'h1n1_knowledge',\n"", "" 'behavioral_antiviral_meds',\n"", "" 'behavioral_avoidance',\n"", "" 'behavioral_face_mask',\n"", """
"'behavioral_wash_hands',\n"", "" 'behavioral_large_gatherings',\n"", "" 'behavi...\n"", "" 'chronic_med_condition',\n"", "" 'child_under_6_months',\n"", "" 'health_worker',\n"", "" 'health_insurance',\n"", """
"'opinion_h1n1_vacc_effective',\n"", "" 'opinion_h1n1_risk',\n"", "" 'opinion_h1n1_sick_from_vacc',\n"", "" 'opinion_seas_vacc_effective',\n"", "" 'opinion_seas_risk',\n"", """
"'opinion_seas_sick_from_vacc',\n"", "" 'household_adults',\n"", "" 'household_children'])])),\n"", "" ('estimators',\n"", "" MultiOutputClassifier(estimator=LogisticRegression(C=1)))])"" ] },"
"""execution_count"": 91, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": [ ""full_pipeline"" ] }, { ""cell_type"": ""code"", ""execution_count"": 93, ""id"": ""c5b7da49-f756-4d45-9b26-"
"a919b021e79b"", ""metadata"": {}, ""outputs"": [], ""source"": [ ""X_train, X_eval, y_train, y_eval = train_test_split(\n"", "" features_df,\n"", "" labels_df,\n"", "" test_size=0.33,\n"", "" shuffle=True,\n"", """
"stratify=labels_df,\n"", "" random_state=RANDOM_SEED\n"", "")"" ] }, { ""cell_type"": ""code"", ""execution_count"": 95, ""id"": ""d7e14a07-890b-4ec0-8c79-653c5d73f380"", ""metadata"": {}, ""outputs"": [ {"
"""name"": ""stdout"", ""output_type"": ""stream"", ""text"": [ ""CPU times: total: 297 ms\n"", ""Wall time: 542 ms\n"" ] }, { ""data"": { ""text/plain"": [ ""[array([[0.70908142, 0.29091858],\n"", "" [0.90225178,"
"0.09774822],\n"", "" [0.84461323, 0.15538677],\n"", "" ...,\n"", "" [0.92339044, 0.07660956],\n"", "" [0.8963338 , 0.1036662 ],\n"", "" [0.92792562, 0.07207438]]),\n"", "" array([[0.52725538,"
"0.47274462],\n"", "" [0.6183343 , 0.3816657 ],\n"", "" [0.36998647, 0.63001353],\n"", "" ...,\n"", "" [0.85932929, 0.14067071],\n"", "" [0.77833969, 0.22166031],\n"", "" [0.15114535, 0.84885465]])]"" ] },"
"""execution_count"": 95, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": [ ""%%time\n"", ""\n"", ""# Train model\n"", ""full_pipeline.fit(X_train, y_train)\n"", ""\n"", ""# Predict on evaluation"
"set\n"", ""# This competition wants probabilities, not labels\n"", ""preds = full_pipeline.predict_proba(X_eval)\n"", ""preds"" ] }, { ""cell_type"": ""code"", ""execution_count"": 97, ""id"": ""e77be5c3-cee0-"
"41b1-90db-e29de4f102a0"", ""metadata"": {}, ""outputs"": [ { ""name"": ""stdout"", ""output_type"": ""stream"", ""text"": [ ""test_probas[0].shape (8814, 2)\n"", ""test_probas[1].shape (8814, 2)\n"" ] } ],"
"""source"": [ ""print(\""test_probas[0].shape\"", preds[0].shape)\n"", ""print(\""test_probas[1].shape\"", preds[1].shape)"" ] }, { ""cell_type"": ""code"", ""execution_count"": 99, ""id"": ""7271bbb3-c1cf-4be4-"
"873b-ab49eeb8eaff"", ""metadata"": {}, ""outputs"": [ { ""name"": ""stdout"", ""output_type"": ""stream"", ""text"": [ ""y_preds.shape: (8814, 2)\n"" ] }, { ""data"": { ""text/html"": [ """
"\n"", ""\n"", ""\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"h1n1_vaccine seasonal_vaccine"
"respondent_id"
"6728           0.290919            0.472745"
"16516          0.097748            0.381666"
"3106           0.155387            0.630014"
"16981          0.661696            0.857856"
"19111          0.284458            0.776957"
"\n"", """
""" ], ""text/plain"": [ "" h1n1_vaccine seasonal_vaccine\n"", ""respondent_id \n"", ""6728 0.290919 0.472745\n"", ""16516 0.097748 0.381666\n"", ""3106 0.155387 0.630014\n"", ""16981 0.661696"
"0.857856\n"", ""19111 0.284458 0.776957"" ] }, ""execution_count"": 99, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": [ ""y_preds = pd.DataFrame(\n"", "" {\n"", "" \""h1n1_vaccine\"":"
"preds[0][:, 1],\n"", "" \""seasonal_vaccine\"": preds[1][:, 1],\n"", "" },\n"", "" index = y_eval.index\n"", "")\n"", ""print(\""y_preds.shape:\"", y_preds.shape)\n"", ""y_preds.head()"" ] }, { ""cell_type"": ""code"","
"""execution_count"": 101, ""id"": ""9d738f9d-4d14-4ff3-899e-090cdddad622"", ""metadata"": {}, ""outputs"": [], ""source"": [ ""def plot_roc(y_true, y_score, label_name, ax):\n"", "" fpr, tpr, thresholds ="
"roc_curve(y_true, y_score)\n"", "" ax.plot(fpr, tpr)\n"", "" ax.plot([0, 1], [0, 1], color='grey', linestyle='--')\n"", "" ax.set_ylabel('TPR')\n"", "" ax.set_xlabel('FPR')\n"", "" ax.set_title(\n"", "" f\""{label_name}:"
"AUC = {roc_auc_score(y_true, y_score):.4f}\""\n"", "" )"" ] }, { ""cell_type"": ""code"", ""execution_count"": 113, ""id"": ""2336a0fe-c579-4e9c-8d1e-eb8d5df465b8"", ""metadata"": {}, ""outputs"": [ { ""data"": {"
"""image/png"":"
"""iVBORw0KGgoAAAANSUhEUgAAAq8AAAFUCAYAAAAK3NXaAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjkuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8hTgPZAAAACXBIWXMA"
"""text/plain"": [ """
""
""" ] }, ""metadata"": {}, ""output_type"": ""display_data"" }, { ""data"": { ""image/png"":"
"""iVBORw0KGgoAAAANSUhEUgAAAq8AAAFUCAYAAAAK3NXaAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjkuMiwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8hTgPZAAAACXBIW"
"""text/plain"": [ """
""
""" ] }, ""metadata"": {}, ""output_type"": ""display_data"" } ], ""source"": [ ""fig, ax = plt.subplots(1, 2, figsize=(7, 3.5))\n"", ""\n"", ""plot_roc(\n"", "" y_eval['h1n1_vaccine'], \n"", """
"y_preds['h1n1_vaccine'], \n"", "" 'h1n1_vaccine',\n"", "" ax=ax[0]\n"", "")\n"", ""plot_roc(\n"", "" y_eval['seasonal_vaccine'], \n"", "" y_preds['seasonal_vaccine'], \n"", """
"'seasonal_vaccine',\n"", "" ax=ax[1]\n"", "")\n"", ""fig.tight_layout()\n"", ""plt.show()"" ] }, { ""cell_type"": ""code"", ""execution_count"": 115, ""id"": ""88019f6c-a06d-4fa4-9c97-"
"b5b7d38d6c66"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""text/plain"": [ ""0.829471627204796"" ] }, ""execution_count"": 115, ""metadata"": {}, ""output_type"": ""execute_result"" }"
"], ""source"": [ ""roc_auc_score(y_eval, y_preds)"" ] }, { ""cell_type"": ""code"", ""execution_count"": 117, ""id"": ""75cf1437-b331-43c3-817b-9a12f3596efc"", ""metadata"": {},"
"""outputs"": [ { ""name"": ""stdout"", ""output_type"": ""stream"", ""text"": [ ""CPU times: total: 234 ms\n"", ""Wall time: 368 ms\n"" ] } ], ""source"": [ ""%%time \n"", ""\n"","
"""full_pipeline.fit(features_df, labels_df)\n"", ""\n"", ""None "" ] }, { ""cell_type"": ""code"", ""execution_count"": 121, ""id"": ""90fea0b7-8abe-46ae-b5ab-52db3aebbf2e"", ""metadata"":"
"{}, ""outputs"": [], ""source"": [ ""test_features_df = pd.read_csv(\""test_set_features.csv\"", \n"", "" index_col=\""respondent_id\"")"" ] }, { ""cell_type"": ""code"", ""execution_count"":"
"123, ""id"": ""27d5437c-bf15-4759-a2ac-b13e4c120105"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""text/plain"": [ ""[array([[0.87278975, 0.12721025],\n"", "" [0.94475452,"
"0.05524548],\n"", "" [0.62901312, 0.37098688],\n"", "" ...,\n"", "" [0.80410138, 0.19589862],\n"", "" [0.94924251, 0.05075749],\n"", "" [0.38422244, 0.61577756]]),\n"", """
"array([[0.57373849, 0.42626151],\n"", "" [0.92879979, 0.07120021],\n"", "" [0.36253527, 0.63746473],\n"", "" ...,\n"", "" [0.59852884, 0.40147116],\n"", "" [0.67991602,"
"0.32008398],\n"", "" [0.35780542, 0.64219458]])]"" ] }, ""execution_count"": 123, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": [ ""test_probas ="
"full_pipeline.predict_proba(test_features_df)\n"", ""test_probas"" ] }, { ""cell_type"": ""code"", ""execution_count"": 127, ""id"": ""2925c882-6b1a-4400-8620-6953d57bb3c8"","
"""metadata"": {}, ""outputs"": [], ""source"": [ ""submission_df = pd.read_csv(\""submission_format.csv\"", \n"", "" index_col=\""respondent_id\"")"" ] }, { ""cell_type"": ""code"","
"""execution_count"": 129, ""id"": ""e7fdb366-d7aa-44c8-b12d-ef6aed8d7798"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""text/html"": [ """
"\n"", ""\n"", ""\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"","
""" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"h1n1_vaccine seasonal_vaccine"
"respondent_id"
"26707         0.5                 0.7"
"26708         0.5                 0.7"
"26709         0.5                 0.7"
"26710         0.5                 0.7"
"26711         0.5                 0.7"
"\n"", """
""" ], ""text/plain"": [ "" h1n1_vaccine seasonal_vaccine\n"", ""respondent_id \n"", ""26707 0.5 0.7\n"", ""26708 0.5 0.7\n"", ""26709 0.5 0.7\n"", ""26710 0.5 0.7\n"", ""26711 0.5 0.7"" ]"
"}, ""execution_count"": 129, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": [ ""submission_df.head()"" ] }, { ""cell_type"": ""code"", ""execution_count"": 131, ""id"":"
"""6ce8ca24-8953-471b-a610-eff0aea5734e"", ""metadata"": {}, ""outputs"": [ { ""data"": { ""text/html"": [ """
"\n"", ""\n"", ""\n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"","
""" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", "" \n"", """
"h1n1_vaccine seasonal_vaccine"
"respondent_id"
"26707         0.127210            0.426262"
"26708         0.055245            0.071200"
"26709         0.370987            0.637465"
"26710         0.464168            0.803559"
"26711         0.286598            0.634874"
"\n"", """
""" ], ""text/plain"": [ "" h1n1_vaccine seasonal_vaccine\n"", ""respondent_id \n"", ""26707 0.127210 0.426262\n"", ""26708 0.055245 0.071200\n"", ""26709 0.370987"
"0.637465\n"", ""26710 0.464168 0.803559\n"", ""26711 0.286598 0.634874"" ] }, ""execution_count"": 131, ""metadata"": {}, ""output_type"": ""execute_result"" } ], ""source"": ["
"""np.testing.assert_array_equal(test_features_df.index.values, \n"", "" submission_df.index.values)\n"", ""\n"", ""# Save predictions to submission data frame\n"","
"""submission_df[\""h1n1_vaccine\""] = test_probas[0][:, 1]\n"", ""submission_df[\""seasonal_vaccine\""] = test_probas[1][:, 1]\n"", ""\n"", ""submission_df.head()"" ] }, { ""cell_type"":"
"""code"", ""execution_count"": 133, ""id"": ""47357f95-da3f-44ac-853b-a12e91a92a47"", ""metadata"": {}, ""outputs"": [], ""source"": [ ""submission_df.to_csv('my_submission.csv',"
"index=True)"" ] }, { ""cell_type"": ""code"", ""execution_count"": null, ""id"": ""fdd13c25-854f-47b1-a5d1-029aad1cd5ba"", ""metadata"": {}, ""outputs"": [], ""source"": [] }, { ""cell_type"":"
"""code"", ""execution_count"": null, ""id"": ""88bf6e25-5a5d-45a0-a788-15888e13c260"", ""metadata"": {}, ""outputs"": [], ""source"": [] } ], ""metadata"": { ""kernelspec"": {"
"""display_name"": ""Python [conda env:base] *"", ""language"": ""python"", ""name"": ""conda-base-py"" }, ""language_info"": { ""codemirror_mode"": { ""name"": ""ipython"", ""version"":"
"3 }, ""file_extension"": "".py"", ""mimetype"": ""text/x-python"", ""name"": ""python"", ""nbconvert_exporter"": ""python"", ""pygments_lexer"": ""ipython3"", ""version"": ""3.12.7"" } },"
"""nbformat"": 4, ""nbformat_minor"": 5 }"
""
